import{r as m,j as s,a as f,G as A,u as b,s as v,L as F}from"./index-ovBpk-RT.js";import{u,S as L}from"./SongCard-ORRAww1V.js";import{I as C,A as I}from"./Artists-BE7LC3R-.js";const N=({id:i})=>{var t,r;const[l,c]=m.useState(!1),d=`/api/songs/${i}/lyrics`,{loading:g,error:n,data:a}=u(d);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`Lyrics ${l?"fullView":""}`,children:!g&&!n&&a&&s.jsxs(s.Fragment,{children:["lyrics"in a&&((t=a==null?void 0:a.lyrics)==null?void 0:t.split("<br>").map((e,o)=>s.jsx("p",{children:e},o))),"copyright"in a&&((r=a==null?void 0:a.copyright)==null?void 0:r.split("<br>").map((e,o)=>s.jsx("h4",{children:e},o)))]})}),s.jsx("button",{className:"readMore",onClick:()=>c(e=>!e),children:l?"Read less":"Read more"})]})},$=({id:i,setAllSongData:l})=>{const c=`/api/songs/${i}/suggestions?limit=10`,{loading:d,error:g,data:n}=u(c);return m.useEffect(()=>{!d&&!g&&Array.isArray(n)&&l(a=>[...a,...n])},[n]),s.jsx("div",{className:"SimilarSongs",style:{marginBottom:"20px"},children:!d&&!g&&Array.isArray(n)&&n.map(a=>s.jsx(L,{result:a},a.id))})},E=m.memo($),k=({id:i,currentSongId:l})=>{var t;const c=`/api/albums?id=${i}`,{loading:d,error:g,data:n}=u(c),a=f();return s.jsx("div",{className:"SongFromAlbum",children:!d&&!g&&n&&!Array.isArray(n)&&s.jsx(s.Fragment,{children:(t=n==null?void 0:n.songs)==null?void 0:t.filter(r=>r.id!==l).map(r=>{var e,o;return s.jsxs("div",{className:"songInAlbum",onClick:()=>a(`/song/${r.id}`),children:[s.jsx("img",{src:((o=(e=r.image)==null?void 0:e[1])==null?void 0:o.url)||"../../../music.png",alt:""}),s.jsx("p",{children:r.name})]},r.id)})})})};function w(i){return A({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M18.25 15.5a.75.75 0 0 1-.75-.75V7.56L7.28 17.78a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L16.44 6.5H9.25a.75.75 0 0 1 0-1.5h9a.75.75 0 0 1 .75.75v9a.75.75 0 0 1-.75.75Z"},child:[]}]})(i)}const G=()=>{var h,x,j;const{id:i}=b(),l=f(),c=m.useContext(v);if(!i)return s.jsx("p",{children:"Invalid Song"});if(!c)return null;const{setTracks:d,setSongIndex:g}=c,n=`/api/songs/${i}`,{loading:a,error:t,data:r}=u(n),[e,o]=m.useState([]);m.useEffect(()=>{!a&&!t&&Array.isArray(r)&&o([...r])},[r]);const S=m.useCallback(()=>{d(e),g(0)},[e]);return a?s.jsx(F,{}):t?s.jsx("p",{className:"Loading-Error",children:"Error loading album details."}):s.jsx("div",{className:"SongQuerryPage",children:!a&&!t&&r&&Array.isArray(r)&&s.jsxs(s.Fragment,{children:[s.jsx(C,{audioSet:S,data:r[0]}),((h=r[0])==null?void 0:h.hasLyrics)&&s.jsxs(s.Fragment,{children:[s.jsx("h2",{children:"Lyrics"}),s.jsx(N,{id:r[0].id})]}),((j=(x=r[0])==null?void 0:x.album)==null?void 0:j.id)&&s.jsxs(s.Fragment,{children:[s.jsxs("h2",{children:["More from ",s.jsxs("span",{onClick:()=>{var p,y;return l(`/album/${(y=(p=r[0])==null?void 0:p.album)==null?void 0:y.id}`)},children:[r[0].album.name,s.jsx(w,{})]})]}),s.jsx(k,{id:r[0].album.id,currentSongId:i})]}),s.jsx("h2",{children:"Similar songs"}),s.jsx(E,{id:i,setAllSongData:o}),s.jsx("h2",{children:"Artists"}),s.jsx(I,{data:r[0]})]})})};export{G as default};
