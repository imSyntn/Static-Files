import{a as j,j as e,u as E,r as c}from"./index-ovBpk-RT.js";import{u as T,S as C}from"./SongCard-ORRAww1V.js";import{A as S}from"./AlbumThumbnail-DAWuM9Y4.js";const x=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"",N=({result:a})=>{var l,d;const n=j();return e.jsxs("div",{className:"PlaylistThumbnail",onClick:()=>n(`/playlist/${a.id}`),children:[e.jsx("div",{className:"imgWrapperInPlaylistThumbnail",children:e.jsx("img",{src:((d=(l=a==null?void 0:a.image)==null?void 0:l[1])==null?void 0:d.url)||"../../music.png",alt:""})}),e.jsx("h4",{children:(a==null?void 0:a.name.length)>17?`${(a==null?void 0:a.name.slice(0,17))+"..."}`:`${a==null?void 0:a.name}`})]})},L=()=>{const{searchType:a,querry:n}=E(),l=j();if(!a||!n)return;const d=x(a),f=x(n),[y,m]=c.useState(1),[t,p]=c.useState([]),b=`/api/search/${a}?query=${n}&page=${y}&limit=50`,{loading:h,error:v,data:o}=T(b);c.useEffect(()=>{o&&!Array.isArray(o)&&Array.isArray(o.results)&&p(s=>[...s,...o.results])},[o]),c.useEffect(()=>{m(1),p([])},[a,n]);const u=c.useCallback(()=>{const{scrollHeight:s,clientHeight:i,scrollTop:r}=document.documentElement;i+r>=s-200&&!h&&m(A=>A+1)},[h,a,n]),g=(s,i)=>{let r;return()=>{clearTimeout(r),r=setTimeout(s,i)}};return c.useEffect(()=>{const s=g(u,100);return window.addEventListener("scroll",s),()=>{window.removeEventListener("scroll",s)}},[u,g]),v?e.jsx("p",{className:"Loading-Error",children:"Error in loading."}):e.jsxs("div",{className:"SearchQuerryPage",children:[e.jsxs("h1",{children:["Showing ",e.jsx("span",{children:d})," for ",e.jsx("span",{children:f})]}),e.jsxs("div",{className:`searchQuerryContainer ${a!="songs"?"grid":""}`,children:[t.length>0&&e.jsx(e.Fragment,{children:a=="songs"?t.map(s=>e.jsx(C,{result:s},s.id)):a=="albums"?t.map(s=>e.jsx(S,{result:s},s.id)):a=="playlists"?t.map(s=>e.jsx(N,{result:s},s.id)):a=="artists"?t.map(s=>{var i,r;return e.jsxs("div",{className:"artistCont",onClick:()=>l(`/artist/${s.id}`),children:[e.jsx("img",{src:((r=(i=s==null?void 0:s.image)==null?void 0:i[1])==null?void 0:r.url)||"../../../music.png",alt:""}),e.jsx("p",{children:s.name})]},s.id)}):e.jsx("p",{children:"No Data"})}),h&&e.jsx("p",{children:"Loading..."})]})]})};export{L as default};
